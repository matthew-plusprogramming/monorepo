{
  "sequences": [
    {
      "name": "build-deploy-api-lambda",
      "description": "Build and deploy the API lambda using the orchestrator.",
      "steps": [
        "npm -w node-server run decrypt-envs",
        "node scripts/deploy-orchestrator.mjs deploy myapp-api-lambda-stack",
        "npm -w node-server run encrypt-envs"
      ]
    },
    {
      "name": "deploy-infra",
      "description": "Deploy all infrastructure stacks (api-stack, analytics-stack).",
      "steps": [
        "node scripts/deploy-orchestrator.mjs deploy infra"
      ]
    },
    {
      "name": "deploy-lambdas",
      "description": "Build and deploy all Lambda stacks.",
      "steps": [
        "node scripts/deploy-orchestrator.mjs deploy lambdas"
      ]
    },
    {
      "name": "full-deploy",
      "description": "Full deployment: build everything, deploy all stacks in order.",
      "steps": [
        "node scripts/deploy-orchestrator.mjs prepare",
        "node scripts/deploy-orchestrator.mjs deploy all"
      ]
    },
    {
      "name": "clean-and-deploy",
      "description": "Clean rebuild followed by full deployment.",
      "steps": [
        "npm run clean",
        "npm i",
        "node scripts/deploy-orchestrator.mjs prepare",
        "node scripts/deploy-orchestrator.mjs deploy all",
        "npm run test"
      ]
    },
    {
      "name": "refresh-outputs",
      "description": "Pull fresh outputs from all deployed infrastructure stacks.",
      "steps": [
        "node scripts/deploy-orchestrator.mjs outputs infra"
      ]
    }
  ]
}
